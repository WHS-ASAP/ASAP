<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SQL Injection Analysis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/font_style.css') }}" />
    <!-- 기타 필요한 스타일시트나 스크립트 링크 -->
  </head>
  <body>
    <div class="card">
      <div class="card-body">
        <div class="d-sm-flex align-items-center mb-4"></div>
        <h2 class="card-title custom-font" style="font-size: 150%">취약점이 발생하는 원리</h2>
        <ul style="list-style-type: none" class="custom-font">
          <li>소스코드 내에 인젝션이 가능한 SQL 구문dl 포함되는 경우</li>
          <li>인젝션 가능한 SQL문이 코드 내에서 실행되는 경우</li>
          <li>사용자 입력값을 검증하지 않는 경우</li>
        </ul>

        <h2 class="card-title custom-font" style="font-size: 150%">취약점 악용 가능성</h2>
        <ul style="list-style-type: none" class="custom-font">
          <li>
            SQL Injection을 통해 공격자가 DB에 저장돼 있는 데이터들을 무단으로 검색, 삽입, 삭제,
            수정할 수 있음
          </li>
        </ul>
        <h2 class="card-title" style="font-size: 150%">Relative CVE</h2>
        <ul style="list-style-type: none">
          <li>
            <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-31974"
              >CVE-2024-31974</a
            >
            |
            <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-31975"
              >CVE-2024-31975</a
            >
            |
            <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-31976"
              >CVE-2024-31976</a
            >
          </li>
        </ul>
      </div>
    </div>

    {% set result_list = result.result.strip('[]').split('),') %}
    <h3>Results for</h3>
    <p>{{ result.file_path }}</p>
    <div class="table-responsive border rounded p-1 shadow">
      <table class="table">
        <tr>
          <th>Line</th>
          <th>SQL Query</th>
        </tr>
        {% for item in result_list %} {% set parts = item.strip('() ').split(',', 1) %} {% if
        parts|length == 2 %}
        <tr>
          <td>Line {{ parts[0] }}</td>
          <td>{{ parts[1].strip("' ") }}</td>
        </tr>
        {% endif %} {% endfor %}
      </table>
    </div>
  </body>
</html>
